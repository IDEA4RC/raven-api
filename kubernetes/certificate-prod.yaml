apiVersion: cert-manager.io/v1
kind: Certificate
metadata:
  name: raven-api-tls
  namespace: istio-system  # Debe estar en el mismo namespace que el Gateway
spec:
  # Nombre del secreto donde se almacenará el certificado
  secretName: raven-api-tls-secret
  
  # Configuración del certificado
  issuerRef:
    name: letsencrypt-prod  # Usar el ClusterIssuer de producción
    kind: ClusterIssuer
    group: cert-manager.io
  
  # Dominio para el certificado
  dnsNames:
  - orchestrator.idea.lst.tfo.upm.es
  
  # Configuración adicional
  duration: 2160h  # 90 días
  renewBefore: 360h  # Renovar 15 días antes de expirar
  
  # Uso del certificado
  usages:
  - digital signature
  - key encipherment
